
# Лабораторная работа №8  
## Элементы криптографии. Однократное гаммирование

### 8.1 Цель работы
Освоить на практике применение режима однократного гаммирования на примере кодирования различных исходных текстов одним ключом.

---

### 8.2 Исходные данные

**Открытые тексты (телеграммы Центра):**

- `P1 = НаВашисходящийот1204`  
- `P2 = ВСеверныйфилиалБанка`

**Ключ Центра (K), длина — 20 байт:**

```
K = 05 0C 17 7F 0E 4E 37 D2 94 10 09 2E 22 57 FF C8 0B B2 70 54
```

---

### 8.3 Теоретическая основа

#### Формулы шифрования:
- `C1 = P1 ⊕ K`
- `C2 = P2 ⊕ K`

#### Взлом шифра:
Если известны C1 и C2, можно вычислить:
- `C1 ⊕ C2 = P1 ⊕ P2`

При известном шаблоне одного из текстов (например, P1), можно восстановить другой текст:
- `P2 = C1 ⊕ C2 ⊕ P1`

---

### 8.4 Выполнение работы

#### Шаг 1: Подготовка данных
**Описание действия:** Конвертация P1 и P2 в байтовое представление (UTF-8 или CP1251).

**Команда (Python):**
```python
P1 = 'НаВашисходящийот1204'.encode('cp1251')
P2 = 'ВСеверныйфилиалБанка'.encode('cp1251')
K = bytes.fromhex('05 0C 17 7F 0E 4E 37 D2 94 10 09 2E 22 57 FF C8 0B B2 70 54')
```

**Результат:** Переменные P1, P2 и K готовы для гаммирования.

---

#### Шаг 2: Шифрование
**Описание действия:** Однократное гаммирование P1 и P2 ключом K.

**Команда (Python):**
```python
def xor_bytes(data, key):
    return bytes([b ^ k for b, k in zip(data, key)])

C1 = xor_bytes(P1, K)
C2 = xor_bytes(P2, K)
```

**Результат (в hex):**
```python
print(C1.hex())
print(C2.hex())
```
*(Скриншот с выводом C1 и C2)*

---

#### Шаг 3: Анализ без знания ключа
**Описание действия:** Находим `C1 ⊕ C2` и затем `P2 = C1 ⊕ C2 ⊕ P1`

**Команда (Python):**
```python
P1_xor_P2 = xor_bytes(C1, C2)
Recovered_P2 = xor_bytes(P1_xor_P2, P1)
print(Recovered_P2.decode('cp1251'))
```

**Результат:**
```
ВСеверныйфилиалБанка
```

*(Скриншот с выводом расшифрованного текста)*

---

### 8.5 Вывод

В ходе лабораторной работы было:

- Реализовано шифрование и дешифрование текста по режиму однократного гаммирования;
- Показана уязвимость метода при повторном использовании одного и того же ключа;
- Выполнена атака с использованием известных шаблонов сообщения без знания ключа;
- Подтверждена возможность восстановления второго сообщения по XOR-операциям.
